<?xml version="1.0"?>
<robot name="Rodney">

  <material name="blue">
    <color rgba="0 0 0.8 1"/>
  </material>
  
  <material name="white">
    <color rgba="1 1 1 1"/>
  </material>
  
  <material name="black">
    <color rgba="0 0 0 1"/>
  </material>  
  
  <material name="silver">
    <color rgba="0.75 0.75 0.75 1"/>
  </material>   
  
  <material name="bronze">
    <color rgba="0.8 0.498 0.196 1"/>
  </material>  
  
  <link name="base_link">
    <visual>      
      <geometry>        
        <mesh filename="package://rodney/meshes/rodneyBase.dae"/>        
      </geometry>      
    </visual>
    <collision>
      <geometry>
        <box size="0.340 0.180 0.008"/>
      </geometry>
      <origin xyz="0.0 0.0 0.004"/>
    </collision>
    <inertial>
      <mass value="0.297"/>
      <inertia ixx="0.000803" ixy="0.0" ixz="0.0" iyy="0.003663" iyz="0.0" izz="0.002863"/>      
    </inertial>
  </link>
  
  <!-- Battery packs -->

  <link name="AAx10">
    <visual>
      <geometry>
        <box size="0.075 0.056 0.030"/>
      </geometry>
      <origin xyz="0.0 0.0 -0.015"/>
      <material name="black" />
    </visual>
    <collision>
      <geometry>
        <box size="0.075 0.056 0.030"/>
      </geometry>    
      <origin xyz="0.0 0.0 -0.015"/>
    </collision>
    <inertial>
      <mass value="0.259"/>
      <inertia ixx="8.71e-5" ixy="0.0" ixz="0.0" iyy="0.000189" iyz="0.0" izz="0.000141"/>
    </inertial>    
  </link>
  
  <joint name="base_to_AAx10" type="fixed">
    <parent link="base_link"/>
    <child link="AAx10"/>
    <origin xyz="0.060 0.0 0.0"/>
  </joint>  
       
  <link name="USB_PACK">
    <visual>
      <geometry>
        <box size="0.146 0.074 0.020"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/>
      <material name="black" />
    </visual>
    <collision>
      <geometry>
        <box size="0.146 0.074 0.020"/>
      </geometry>    
      <origin xyz="0.0 0.0 0.010"/>
    </collision>
    <inertial>
      <mass value="0.358"/>
      <inertia ixx="0.000175" ixy="0.0" ixz="0.0" iyy="0.000799" iyz="0.0" izz="0.000648"/>
    </inertial>    
  </link>
  
  <joint name="base_to_USB_PACK" type="fixed">
    <parent link="base_link"/>
    <child link="USB_PACK"/>
    <origin xyz="0.060 0.0 0.008"/>
  </joint>  
           
  <!-- Motors and wheels -->
  
  <!-- left -->

  <link name="left_motor_bracket">
    <visual>
      <geometry>
        <box size="0.042 0.049 0.002"/>
      </geometry>      
      <origin rpy="1.58 0 0" xyz="0.0 0.0 -0.0245"/>      
      <material name="bronze"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.042 0.049 0.002"/>
      </geometry>
      <origin rpy="1.58 0 0" xyz="0.0 0.0 -0.0245"/>
    </collision>
    <inertial>
      <mass value="0.035"/>
      <inertia ixx="7.01e-6" ixy="0.0" ixz="0.0" iyy="1.21e-5" iyz="0.0" izz="5.16e-6"/>
    </inertial>    
  </link>

  <joint name="base_to_l_motor_brk" type="fixed">
    <parent link="base_link"/>
    <child link="left_motor_bracket"/>
    <origin xyz="0.0 0.095 0.0"/>
  </joint>
        
  <link name="left_motor">
    <visual>
      <geometry>
        <cylinder length="0.056" radius="0.0185"/>
      </geometry>
      <origin rpy="1.57 0 0" xyz="0.0 -0.028 0.0"/>
      <material name="silver"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.056" radius="0.0185"/>
      </geometry>
      <origin rpy="1.57 0 0" xyz="0.0 -0.028 0.0"/>
    </collision>
    <inertial>
      <mass value="0.196"/>
      <inertia ixx="6.79916e-5" ixy="0.0" ixz="0.0" iyy="6.79916e-5" iyz="0.0" izz="3.35405e-5"/>
    </inertial>               
  </link>
  
  <joint name="l_brk_to_l_motor" type="fixed">
    <parent link="left_motor_bracket"/>
    <child link="left_motor"/>    
    <origin xyz="0.0 -0.001 -0.028"/>
  </joint>
 
  <link name="left_wheel">
    <visual>
      <geometry>
        <cylinder length="0.050" radius="0.053"/>
      </geometry>
      <origin rpy="1.57 0 0" xyz="0.0 0.025 0.0"/>      
      <material name="black"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.050" radius="0.053"/>
      </geometry>
      <origin rpy="1.57 0 0" xyz="0.0 0.025 0.0"/>     
    </collision>
    <inertial>
      <mass value="0.117"/>
      <inertia ixx="0.000106538" ixy="0.0" ixz="0.0" iyy="0.000106538" iyz="0.0" izz="0.000164327"/>
    </inertial>   
  </link>

  <joint name="l_brk_to_wheel" type="continuous">
    <axis xyz="0 1 0"/>
    <parent link="left_motor_bracket"/>
    <child link="left_wheel"/>
    <dynamic damping="200.0" friction="200.0" />
    <origin xyz="0.0 0.001 -0.034"/>
  </joint> 
  
  <!-- right -->
  
  <link name="right_motor_bracket">
    <visual>
      <geometry>
        <box size="0.042 0.049 0.002"/>
      </geometry>
      <origin rpy="1.58 0 0" xyz="0.0 0.0 -0.0245"/>      
      <material name="bronze"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.042 0.049 0.002"/>
      </geometry>
      <origin rpy="1.58 0 0" xyz="0.0 0.0 -0.0245"/>
    </collision>
    <inertial>
      <mass value="0.035"/>
      <inertia ixx="7.01e-6" ixy="0.0" ixz="0.0" iyy="1.21e-5" iyz="0.0" izz="5.16e-6"/>
    </inertial>     
  </link>

  <joint name="base_to_r_motor_brk" type="fixed">
    <parent link="base_link"/>
    <child link="right_motor_bracket"/>
    <origin xyz="0.0 -0.095 0.0"/>
  </joint>
           
  <link name="right_motor">
    <visual>
      <geometry>
        <cylinder length="0.056" radius="0.0185"/>
      </geometry>
      <origin rpy="1.57 0 0" xyz="0.0 0.028 0.0"/>      
      <material name="silver"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.056" radius="0.0185"/>
      </geometry>
      <origin rpy="1.57 0 0" xyz="0.0 0.028 0.0"/>
    </collision>
    <inertial>
      <mass value="0.196"/>
      <inertia ixx="6.79916e-5" ixy="0.0" ixz="0.0" iyy="6.79916e-5" iyz="0.0" izz="3.35405e-5"/>
    </inertial>     
  </link>
  
  <joint name="r_brk_to_r_motor" type="fixed">
    <parent link="right_motor_bracket"/>
    <child link="right_motor"/>    
    <origin xyz="0.0 0.001 -0.028"/>
  </joint>
   
  <link name="right_wheel">
    <visual>
      <geometry>
        <cylinder length="0.050" radius="0.053"/>
      </geometry>
      <origin rpy="1.57 0 0" xyz="0.0 -0.025 0.0"/>      
      <material name="black"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.050" radius="0.053"/>
      </geometry>
      <origin rpy="1.57 0 0" xyz="0.0 -0.025 0.0"/>     
    </collision>
    <inertial>
      <mass value="0.117"/>
      <inertia ixx="0.000106538" ixy="0.0" ixz="0.0" iyy="0.000106538" iyz="0.0" izz="0.000164327"/>
    </inertial>    
  </link>
  
  <joint name="r_brk_to_wheel" type="continuous">
    <axis xyz="0 1 0"/>
    <parent link="right_motor_bracket"/>
    <child link="right_wheel"/>
    <dynamic damping="200.0" friction="200.0" />
    <origin xyz="0.0 -0.001 -0.034"/>
  </joint>
  
  <!-- Casters -->
  <!-- Front -->
  <link name="front_caster_bracket">
    <visual>
      <geometry>
        <box size="0.025 0.040 0.060"/>
      </geometry>
      <origin xyz="0.0 0.0 0.030"/>
      <material name="blue" />
    </visual>
    <collision>
      <geometry>
        <box size=".025 0.040 0.060"/>
      </geometry>    
      <origin xyz="0.0 0.0 0.030"/>
    </collision>
    <inertial>
      <mass value="0.030"/>
      <inertia ixx="0.000013" ixy="0.0" ixz="0.0" iyy="5.56e-6" iyz="0.0" izz="1.06e-5"/>
    </inertial> 
  </link>
  
  <joint name="base_to_front_caster" type="fixed">
    <parent link="base_link"/>
    <child link="front_caster_bracket"/>
    <origin xyz="0.150 0.0 -0.060"/>
  </joint>
  
  <link name="front_caster">
    <visual>
      <geometry>
        <sphere radius="0.020"/>
      </geometry>
      <origin xyz="0.0 0.0 0.0"/>
      <material name="white" />
    </visual>
    <collision>
      <geometry>
        <sphere radius="0.020"/>
      </geometry>    
      <origin xyz="0.0 0.0 0.0"/>
    </collision>
    <inertial>
      <mass value="0.003"/>
      <inertia ixx="5e-6" ixy="0.0" ixz="0.0" iyy="5e-6" iyz="0.0" izz="5e-6"/>
    </inertial>     
  </link>      

  <joint name="front_caster_bk_to_ball" type="continuous">
    <axis xyz="1 1 1"/>
    <parent link="front_caster_bracket"/>
    <child link="front_caster"/>
    <origin xyz="0.0 0.0 0.0"/>
  </joint>
    
  <!-- Rear -->
  <link name="rear_caster_bracket">
    <visual>
      <geometry>
        <box size="0.025 0.040 0.060"/>
      </geometry>
      <origin xyz="0.0 0.0 0.030"/>
      <material name="blue" />
    </visual>
    <collision>
      <geometry>
        <box size=".025 0.040 0.060"/>
      </geometry>    
      <origin xyz="0.0 0.0 0.030"/>
    </collision>
    <inertial>
      <mass value="0.030"/>
      <inertia ixx="0.000013" ixy="0.0" ixz="0.0" iyy="5.56e-6" iyz="0.0" izz="1.06e-5"/>
    </inertial> 
  </link>
  
  <joint name="base_to_rear_caster" type="fixed">
    <parent link="base_link"/>
    <child link="rear_caster_bracket"/>
    <origin xyz="-0.150 0.0 -0.060"/>
  </joint>    

  <link name="rear_caster">
    <visual>
      <geometry>
        <sphere radius="0.020"/>
      </geometry>
      <origin xyz="0.0 0.0 0.0"/>
      <material name="white" />
    </visual>
    <collision>
      <geometry>
        <sphere radius="0.020"/>
      </geometry>    
      <origin xyz="0.0 0.0 0.0"/>
    </collision>
    <inertial>
      <mass value="0.003"/>
      <inertia ixx="5e-6" ixy="0.0" ixz="0.0" iyy="5e-6" iyz="0.0" izz="5e-6"/>
    </inertial> 
  </link>      

  <joint name="rear_caster_bk_to_ball" type="continuous">
    <axis xyz="1 1 1"/>
    <parent link="rear_caster_bracket"/>
    <child link="rear_caster"/>
    <origin xyz="0.0 0.0 0.0"/>
  </joint>         
  
  <!-- Rear platform -->

  <link name="post_1">
    <visual>
      <geometry>
        <cylinder length="0.020" radius="0.005"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/>      
      <material name="blue"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.020" radius="0.005"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/> 
    </collision>
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="3.95833e-8" ixy="0.0" ixz="0.0" iyy="3.95833e-8" iyz="0.0" izz="1.25e-8"/>
    </inertial>           
  </link>
  
  <joint name="base_to_post_1" type="fixed">
    <parent link="base_link"/>
    <child link="post_1"/>
    <origin xyz="-0.06 0.08 0.008"/>
  </joint>
 
  <link name="post_2">
    <visual>
      <geometry>
        <cylinder length="0.020" radius="0.005"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/>      
      <material name="blue"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.020" radius="0.005"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/> 
    </collision>
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="3.95833e-8" ixy="0.0" ixz="0.0" iyy="3.95833e-8" iyz="0.0" izz="1.25e-8"/>
    </inertial>    
  </link>
  
  <joint name="base_to_post_2" type="fixed">
    <parent link="base_link"/>
    <child link="post_2"/>
    <origin xyz="-0.14 0.08 0.008"/>
  </joint>
  
  <link name="post_3">
    <visual>
      <geometry>
        <cylinder length="0.020" radius="0.005"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/>      
      <material name="blue"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.020" radius="0.005"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/> 
    </collision>
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="3.95833e-8" ixy="0.0" ixz="0.0" iyy="3.95833e-8" iyz="0.0" izz="1.25e-8"/>
    </inertial>    
  </link>
  
  <joint name="base_to_post_3" type="fixed">
    <parent link="base_link"/>
    <child link="post_3"/>
    <origin xyz="-0.06 -0.08 0.008"/>
  </joint>    
 
  <link name="post_4">
    <visual>
      <geometry>
        <cylinder length="0.020" radius="0.005"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/>      
      <material name="blue"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.020" radius="0.005"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/> 
    </collision>
    <inertial>
      <mass value="0.001"/>
      <inertia ixx="3.95833e-8" ixy="0.0" ixz="0.0" iyy="3.95833e-8" iyz="0.0" izz="1.25e-8"/>
    </inertial>    
  </link>
  
  <joint name="base_to_post_4" type="fixed">
    <parent link="base_link"/>
    <child link="post_4"/>
    <origin xyz="-0.14 -0.08 0.008"/>
  </joint>

  <link name="rear_platform">
    <visual>      
      <geometry>        
        <mesh filename="package://rodney/meshes/smallRearPlatform.dae"/>
      </geometry>
      <origin rpy="0 0 1.57" xyz="0.010 -0.080 0.0"/>              
    </visual>
    <collision>      
      <geometry>        
        <box size="0.180 0.098 0.003"/>
      </geometry>
      <origin rpy="0 0 1.57" xyz="-0.04 -0.080 0.0015"/>              
    </collision> 
    <inertial>
      <mass value="0.050"/>
      <inertia ixx="4.01e-5" ixy="0.0" ixz="0.0" iyy="0.000175" iyz="0.0" izz="0.000135"/>
    </inertial>        
  </link>  

  <joint name="post_1_to_rear_platform" type="fixed">
    <parent link="post_1"/>
    <child link="rear_platform"/>
    <origin xyz="0.0 0.0 0.02"/>
  </joint>

  <!-- Neck and head -->
  
  <link name="neck">
    <visual>
      <geometry>
        <cylinder length="0.30" radius="0.011"/>
      </geometry>
      <origin xyz="0 0.0 0.15"/>      
      <material name="white"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.30" radius="0.011"/>
      </geometry>
      <origin xyz="0 0.0 0.15"/>            
    </collision>
    <inertial>
      <mass value="0.033"/>
      <inertia ixx="0.000248498" ixy="0.0" ixz="0.0" iyy="0.000248498" iyz="0.0" izz="1.9965e-6"/>
    </inertial>         
  </link>
  
  <joint name="rear_platform_to_neck" type="fixed">
    <parent link="rear_platform"/>
    <child link="neck"/>
    <origin xyz="-0.070 -0.080 -0.028"/>
  </joint>
  
  <link name="head_fixing">
    <visual>      
      <geometry>        
        <mesh filename="package://rodney/meshes/headFixing.dae"/>
      </geometry>
      <origin xyz="0.0 0.0 -0.040"/>            
    </visual>
    <collision>
      <geometry>        
        <box size="0.03 0.04 0.1"/>
      </geometry>
      <origin xyz="0.0 0.0 0.010"/> 
    </collision>
    <inertial>
      <mass value="0.015"/>
      <inertia ixx="1.45e-5" ixy="0.0" ixz="0.0" iyy="3.13e-6" iyz="0.0" izz="1.36e-5"/>
    </inertial>    
  </link>  

  <joint name="neck_to_head_fixing" type="fixed">
    <parent link="neck"/>
    <child link="head_fixing"/>
    <origin xyz="0.0 0.0 0.30"/>
  </joint>  
  
  <link name="head_pan_servo_block">
    <visual>
      <geometry>
        <box size="0.057 0.032 0.066"/>        
      </geometry>
      <origin xyz="0.008 0.0 -0.008"/>      
      <material name="black"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.057 0.032 0.066"/>        
      </geometry>
      <origin xyz="0.008 0.0 -0.008"/>
    </collision>
    <inertial>
      <mass value="0.084"/>
      <inertia ixx="3.77e-5" ixy="0.0" ixz="0.0" iyy="2.99e-5" iyz="0.0" izz="5.23e-5"/>
    </inertial>               
  </link>      

  <joint name="head_fixing_to_servo_block" type="fixed">
    <parent link="head_fixing"/>
    <child link="head_pan_servo_block"/>
    <origin xyz="0.0 0.0 0.047"/>
  </joint>   

  <link name="head_pan_bracket">
    <visual>      
      <geometry>        
        <mesh filename="package://rodney/meshes/headPanBracket.dae"/>
      </geometry>            
    </visual>
    <collision>
      <geometry>
        <box size="0.025 0.068 0.045"/>
      </geometry>
      <origin xyz="0.0 0.0 0.0225"/>
    </collision>
    <inertial>
      <mass value="0.010"/>   
      <inertia ixx="5.54e-6" ixy="0.0" ixz="0.0" iyy="4.37e-6" iyz="0.0" izz="2.21e-6"/> 
    </inertial>           
  </link>
    
  <joint name="servo_block_to_head_pan_bracket" type="revolute">
    <axis xyz="0 0 1"/>
    <limit effort="1000.0" lower="-1.571" upper="1.571" velocity="0.5"/>
    <parent link="head_pan_servo_block"/>
    <child link="head_pan_bracket"/>
    <dynamic damping="100.0" friction="100.0" />
    <origin xyz="0.0 0.0 0.025"/>    
  </joint>   

  <link name="head_tilt_arm">
    <visual>      
      <geometry>        
        <mesh filename="package://rodney/meshes/headTiltArm.dae"/>
      </geometry>            
    </visual>
    <collision>
      <geometry>
        <box size="0.075 0.065 0.020"/>
      </geometry>
      <origin xyz="0.018 0.0 0.00"/> 
    </collision>
    <inertial>
      <mass value="0.019"/>   
      <inertia ixx="7.32e-6" ixy="0.0" ixz="0.0" iyy="1.56e-5" iyz="0.0" izz="9.54e-6"/> 
    </inertial>            
  </link>    

  <joint name="head_pan_bracket_to_head_tilt_arm" type="revolute">
    <axis xyz="0 1 0"/>    
    <limit effort="1000.0" lower="-1.572" upper="0.3" velocity="0.5"/>
    <parent link="head_pan_bracket"/>
    <child link="head_tilt_arm"/>
    <dynamic damping="100.0" friction="100.0" />
    <origin xyz="0.0 -0.009 0.035"/>
  </joint>   

  <link name="display_bracket">
    <visual>      
      <geometry>        
        <mesh filename="package://rodney/meshes/displayBracket.dae"/>
      </geometry>
      <origin xyz="0.003 0.008 0.0"/>            
    </visual>
    <collision>
      <geometry>
        <box size="0.010 0.146 0.045"/>        
      </geometry>
      <origin xyz="-0.002 0.008 0.015"/>  
    </collision>    
    <inertial>
      <mass value="0.012"/>   
      <inertia ixx="2.33e-5" ixy="0.0" ixz="0.0" iyy="2.14e-5" iyz="0.0" izz="2.13e-6"/> 
    </inertial> 
  </link>    

  <joint name="head_tilt_arm_to_display_bracket" type="fixed">
    <parent link="head_tilt_arm"/>
    <child link="display_bracket"/>
    <origin xyz="0.056 0.0 0.0"/>
  </joint>  

  <link name="display">
    <visual>      
      <geometry>        
        <box size="0.005 0.192 0.110"/>
      </geometry>      
      <material name="black"/>           
    </visual>
    <collision>
      <geometry>
        <box size="0.005 0.192 0.110"/>        
      </geometry>        
    </collision>  
    <inertial>
      <!--<mass value="0.338"/>
      <inertia ixx="0.001379" ixy="0.0" ixz="0.0" iyy="0.001039" iyz="0.0" izz="0.000342"/>-->
      <mass value="0.010"/>
      <inertia ixx="4.08e-5" ixy="0.0" ixz="0.0" iyy="3.07e-5" iyz="0.0" izz="1.01e-5"/>
    </inertial>    
  </link>    

  <joint name="display_bracket_to_display" type="fixed">
    <parent link="display_bracket"/>
    <child link="display"/>
    <origin xyz="0.003 0.008 0.060"/>
  </joint> 
    
  <!-- Gazebo stuff -->
  
  <gazebo reference="left_wheel">
    <material>Gazebo/Black</material>
  </gazebo>
  
  <gazebo reference="right_wheel">
    <material>Gazebo/Black</material>
  </gazebo>
  
  <gazebo reference="post_1">
    <material>Gazebo/Blue</material>
  </gazebo>

  <gazebo reference="post_2">
    <material>Gazebo/Blue</material>
  </gazebo>
  
  <gazebo reference="post_3">
    <material>Gazebo/Blue</material>
  </gazebo>
  
  <gazebo reference="post_4">
    <material>Gazebo/Blue</material>
  </gazebo>  

  <gazebo reference="display">
    <material>Gazebo/Black</material>
  </gazebo>
  
  <gazebo reference="head_pan_servo_block">
    <material>Gazebo/Black</material>
  </gazebo>    
    
  <gazebo reference="AAx10">
    <material>Gazebo/Black</material>
  </gazebo> 
  
  <gazebo reference="USB_PACK">
    <material>Gazebo/Black</material>
  </gazebo>
  
  <gazebo reference="front_caster_bracket">
    <material>Gazebo/Blue</material>
  </gazebo>   
      
  <gazebo reference="rear_caster_bracket">
    <material>Gazebo/Blue</material>
  </gazebo> 
     
  <!-- To control the wheels -->  
  <gazebo>
    <plugin name="skid_steer_drive_controller" filename="libgazebo_ros_skid_steer_drive.so">
      <updateRate>100.0</updateRate>      
      <robotNamespace>/</robotNamespace>
      <leftFrontJoint>l_brk_to_wheel</leftFrontJoint>
      <rightFrontJoint>r_brk_to_wheel</rightFrontJoint>        
      <wheelSeparation>0.180</wheelSeparation>       
      <wheelDiameter>0.106</wheelDiameter>
      <robotBaseFrame>base_link</robotBaseFrame>           
      <torque>1</torque>
      <commandTopic>cmd_vel</commandTopic>
      <broadcastTF>0</broadcastTF>     
    </plugin>    
  </gazebo>    
  
</robot>
